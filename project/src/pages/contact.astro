---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
---

<Layout title="Contact - One Nation">
	<Header />
	<main>
		<section class="contact">
			<div class="container">
				<h1>Contactez-nous</h1>
				<div class="contact-content">
					<div class="contact-info">
						<h2>Parlons de votre projet</h2>
						<p>Nous sommes à votre écoute pour discuter de vos besoins en communication et vous proposer des solutions sur mesure.</p>
						<div class="info-details">
							<div class="info-item">
								<h3>Email</h3>
								<p>contact@onenationagency.com</p>
							</div>
							<div class="info-item">
								<h3>Adresse</h3>
								<p>3 rue de Suresnes<br>75008 Paris, France</p>
							</div>
						</div>
					</div>
					<form class="contact-form" id="contact-form">
						<div class="form-group">
							<div class="input-icon">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
									<circle cx="12" cy="7" r="4"></circle>
								</svg>
							</div>
							<input type="text" id="name" name="from_name" required placeholder=" ">
							<label for="name">Nom complet</label>
						</div>
						<div class="form-group">
							<div class="input-icon">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
									<polyline points="22,6 12,13 2,6"></polyline>
								</svg>
							</div>
							<input type="email" id="email" name="from_email" required placeholder=" ">
							<label for="email">Email</label>
						</div>
						<div class="form-group">
							<div class="input-icon">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
								</svg>
							</div>
							<input type="tel" id="phone" name="phone" placeholder=" ">
							<label for="phone">Téléphone</label>
						</div>
						<div class="form-group">
							<div class="input-icon">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
									<path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
								</svg>
							</div>
							<input type="text" id="company" name="company" placeholder=" ">
							<label for="company">Entreprise</label>
						</div>
						<div class="form-group full-width">
							<div class="input-icon">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<line x1="22" y1="2" x2="11" y2="13"></line>
									<polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
								</svg>
							</div>
							<textarea id="message" name="message" required placeholder=" "></textarea>
							<label for="message">Message</label>
						</div>
						<button type="submit" class="submit-btn">
							<span class="button-text">Envoyer</span>
							<svg class="button-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<line x1="22" y1="2" x2="11" y2="13"></line>
								<polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
							</svg>
						</button>
					</form>
				</div>
			</div>
		</section>
	</main>
</Layout>

<style>
	.contact {
		padding: 8rem 0;
		animation: fadeIn 0.8s ease-out;
	}

	@keyframes fadeIn {
		from {
			opacity: 0;
			transform: translateY(20px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	.container {
		max-width: 1200px;
		margin: 0 auto;
		padding: 0 2rem;
	}

	h1 {
		font-size: 3rem;
		text-align: center;
		margin-bottom: 4rem;
	}

	.contact-content {
		display: grid;
		grid-template-columns: 1fr 1.5fr;
		gap: 4rem;
	}

	.contact-info {
		padding-right: 2rem;
	}

	.contact-info h2 {
		font-size: 2rem;
		margin-bottom: 1.5rem;
	}

	.info-details {
		margin-top: 2rem;
	}

	.info-item {
		margin-bottom: 1.5rem;
	}

	.info-item h3 {
		font-size: 1.2rem;
		margin-bottom: 0.5rem;
	}

	.contact-form {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: 1.5rem;
	}

	.form-group {
		position: relative;
	}

	.full-width {
		grid-column: 1 / -1;
	}

	.input-icon {
		position: absolute;
		left: 1rem;
		top: 50%;
		transform: translateY(-50%);
		width: 20px;
		height: 20px;
		color: var(--color-accent);
		z-index: 1;
		transition: color 0.3s ease;
	}

	.full-width .input-icon {
		top: 1.5rem;
	}

	input, textarea {
		width: 100%;
		padding: 1rem 1rem 1rem 3rem;
		background: rgba(255, 255, 255, 0.05);
		border: 1px solid rgba(255, 255, 255, 0.1);
		border-radius: 12px;
		color: var(--color-white);
		font-family: 'Montserrat', sans-serif;
		font-size: 1rem;
		transition: all 0.3s ease;
	}

	textarea {
		min-height: 150px;
		resize: vertical;
		padding-top: 1.5rem;
	}

	label {
		position: absolute;
		left: 3rem;
		top: 1rem;
		color: var(--color-accent);
		transition: all 0.3s ease;
		pointer-events: none;
		font-size: 0.9rem;
	}

	input:focus ~ label,
	textarea:focus ~ label,
	input:not(:placeholder-shown) ~ label,
	textarea:not(:placeholder-shown) ~ label {
		top: -0.5rem;
		left: 1rem;
		font-size: 0.8rem;
		background: var(--color-background);
		padding: 0 0.5rem;
		color: var(--color-white);
	}

	input:focus,
	textarea:focus {
		outline: none;
		border-color: var(--color-white);
		background: rgba(255, 255, 255, 0.1);
		box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
	}

	input:focus ~ .input-icon,
	textarea:focus ~ .input-icon {
		color: var(--color-white);
	}

	.submit-btn {
		grid-column: 1 / -1;
		background: var(--color-accent);
		border: none;
		color: var(--color-background);
		padding: 1.2rem 2.5rem;
		font-size: 1.1rem;
		font-family: 'Montserrat', sans-serif;
		font-weight: 600;
		cursor: pointer;
		transition: all 0.3s ease;
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 1rem;
		border-radius: 12px;
		box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
		position: relative;
		overflow: hidden;
	}

	.submit-btn:disabled {
		opacity: 0.7;
		cursor: not-allowed;
	}

	.submit-btn:hover:not(:disabled) {
		transform: translateY(-2px);
		box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
		background: var(--color-white);
	}

	.button-icon {
		width: 20px;
		height: 20px;
		transition: transform 0.3s ease;
	}

	.submit-btn:hover:not(:disabled) .button-icon {
		transform: translateX(5px) rotate(-15deg);
	}

	@media (max-width: 768px) {
		.contact-content {
			grid-template-columns: 1fr;
		}

		.contact-info {
			padding-right: 0;
		}

		.contact-form {
			grid-template-columns: 1fr;
		}

		h1 {
			font-size: 2.5rem;
		}

		.contact-info h2 {
			font-size: 1.8rem;
		}

		input, textarea {
			font-size: 16px; /* Prevents zoom on mobile */
		}
	}
</style>

<script>
	import emailjs from '@emailjs/browser';

	// Configuration EmailJS
	emailjs.init("YMmzTiRJqLzjXzAO_");

	document.addEventListener('DOMContentLoaded', () => {
		const form = document.getElementById('contact-form');
		const submitButton = form?.querySelector('button[type="submit"]');
		const buttonText = submitButton?.querySelector('.button-text');
		const originalButtonText = buttonText?.textContent || 'Envoyer';

		form?.addEventListener('submit', async (e) => {
			e.preventDefault();

			if (submitButton && buttonText) {
				submitButton.disabled = true;
				buttonText.textContent = 'Envoi en cours...';
			}

			try {
				// Récupération des valeurs du formulaire
				const formData = {
					from_name: (document.getElementById('name') as HTMLInputElement).value,
					from_email: (document.getElementById('email') as HTMLInputElement).value,
					phone: (document.getElementById('phone') as HTMLInputElement).value,
					company: (document.getElementById('company') as HTMLInputElement).value,
					message: (document.getElementById('message') as HTMLTextAreaElement).value,
					to_name: "One Nation Agency",
					reply_to: (document.getElementById('email') as HTMLInputElement).value,
				};

				console.log("Envoi du formulaire avec les données:", formData);

				// Envoi du formulaire via EmailJS
				const response = await emailjs.send(
					"service_ydm14ny",  // Votre ID de service EmailJS
					"template_nvbeoo1", // Votre ID de template EmailJS
					formData
				);

				console.log("Réponse EmailJS:", response);

				if (response.status === 200) {
					alert('Message envoyé avec succès ! Nous vous contacterons bientôt.');
					form.reset();
				} else {
					throw new Error('Erreur lors de l\'envoi');
				}
			} catch (error) {
				console.error('Erreur lors de l\'envoi:', error);
				alert('Une erreur est survenue lors de l\'envoi du message. Veuillez réessayer.');
			} finally {
				if (submitButton && buttonText) {
					submitButton.disabled = false;
					buttonText.textContent = originalButtonText;
				}
			}
		});
	});
</script>